<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"> 
	<title>坦白说解密</title>
	<link rel="stylesheet" href="http://cdn.static.runoob.com/libs/bootstrap/3.3.7/css/bootstrap.min.css">  
	<script src="http://cdn.static.runoob.com/libs/jquery/2.1.1/jquery.min.js"></script>
	<script src="http://cdn.static.runoob.com/libs/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body>
<div>
<div class="container">
	<h2>解密步骤：</h2>
	<p class="text-justify"><strong>1.点链接进入坦白说数据页面</strong><a class="btn btn-link" href="https://ti.qq.com/cgi-node/honest-say/receive/mine">点我跳转</a><br><br>
	<strong>2.将数据赋值粘贴到下面的文本框</strong><br><br><br>
	<strong>3.即可获得解密信息</strong><br><br><br><br>
	</p>         
</div>
<form role="form">
	<div class="form-group">
		<label for="name">将数据赋值粘贴到下面的文本框</label>
		<br><br>
		<textarea class="form-control" rows="3" id= "rawdata"></textarea>
	</div>
</form>

<table class="table table-bordered">
<thead>
    <tr><td>发送人</td>
    <td>接收人</td>
    <td>标签</td>
</tr></thead>
<tbody id="showcase">
</tbody>
</table>
</div>

	<script>
    function decrypt(a){a=a.replace('*S1*','');var b=[{oe:'0',oK:'1',ow:'2',oi:'3','7e':'4','7K':'5','7w':'6','7i':'7',Ne:'8',NK:'9'},{4:'5',6:'1',n:'0','-':'2',o:'3',v:'4',C:'6',S:'7',c:'8',E:'9'},{5:'1',z:'0',A:'2',i:'3',P:'4',k:'5',s:'6',l:'7',F:'8',q:'9'}],c=[];return a.split('').forEach(function(e,f){if(1==f%4){var g=c.pop();c.push(g+e)}else c.push(e)}),c.map(function(e,f){return b[f%3][e]||'*'}).join('')}function parse(a){if('string'!=typeof a)return[];try{var c,b=JSON.parse(a);if(b instanceof Array)c=b;else{var e=b.data||b;c=e.confesses||e.list||[]}var f=[];return c.forEach(function(g){g.fromEncodeUin&&f.push({from:decrypt(g.fromEncodeUin||''),to:g.toNick||g.toUin+[],say:g.topicName})}),f}catch(g){return a.startsWith('*S1*')||a.startsWith('o')||a.startsWith('7')||a.startsWith('N')?[{from:decrypt(a),to:'',say:''}]:[]}}    
	</script>
	<script>
    document.getElementById('rawdata').addEventListener('keyup',reload_table)
	document.getElementById('rawdata').addEventListener('change',reload_table)
    function reload_table(){
        var r = document.getElementById('rawdata').value
        var s = document.getElementById('showcase')
        var h = ''
        parse(r).forEach(function(x){h+='<tr><td>'+x.from+'</td><td>'+x.to+'</td><td>'+x.say+'</td></tr>'})
        s.innerHTML=h
    }
	</script>
	<div class="alert alert-info">注：部分无法对应的数字会标注为*。</div>
	<footer class="footer navbar-fixed-bottom ">
    <div class="container">
	<p class="text-center">Uknow - Stay hungry Stay foolish</p>
    </div>
	</footer>
</body>
</html>
